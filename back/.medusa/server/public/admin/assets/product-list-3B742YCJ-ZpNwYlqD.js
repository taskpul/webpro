import{u as S,a as w}from"./chunk-PCFUZKDS-DcOLI6xi.js";import{C as A,c as L,p as _}from"./chunk-GB7CZNXI-CY44TIlp.js";import{q,a as E,j as s,p as F,s as k,b as f,c as v,d as z,e as H,f as P,k as R,C as $,H as M,B as g,L as h,O as T,r as C,g as B,h as K,A as N,P as O,T as I,i as V,t as j,l as W,m as G,n as Y,o as Z}from"./index-DdOSbXML.js";import{u as J,_ as Q}from"./chunk-7VJK6HNE-BEBSsUUt.js";import{u as U}from"./chunk-Y4YXZY7R-CLVZk5YF.js";import"./chunk-Z26G6WFJ-Bp9oejZG.js";import{S as X}from"./chunk-2RQLKDBF-OdZvUgC2.js";import{u as ee}from"./chunk-Q33G337Z-BQHmx9TQ.js";import"./chunk-XLDQPLK4-B7w1q8an.js";import"./chunk-ADOCJB6L-BZOwORh1.js";import"./chunk-P3UUX2T6-B1b-Y827.js";import"./chunk-IQBAUTU5-BEEkaJYn.js";import"./chunk-C76H5USB-VyJ6cqJ4.js";import"./chunk-3I6G3NRU-eRCqUyv2.js";import"./chunk-INE2QCSC-DBF9tbZr.js";import"./chunk-X6BAAGCL-BZtcqqR7.js";import"./chunk-DK4WIVY6-CYCbBMOO.js";import"./chunk-SJ3E4T6B-CaDQoSV2.js";import"./chunk-PFKKVLZX-BUfUd_n-.js";import"./chunk-UNM3LPTG-C-e2J3tW.js";import"./react-country-flag.esm-BcOmqiZW.js";import"./chunk-YEDAFXMB-BKFicqAc.js";import"./chunk-M3VFKDXJ-qonQG1d-.js";import"./chunk-AOFGTNG6-CkJBs9dj.js";import"./chunk-EMIHDNB7-CarGCoSL.js";import"./_isIndex-Cj2VejAI.js";import"./index-B-otT4yT.js";import"./Trans-vJDrnLfE.js";var te=()=>({queryKey:F.list({limit:20,offset:0,is_giftcard:!1}),queryFn:async()=>k.admin.product.list({limit:20,offset:0,is_giftcard:!1})}),$e=e=>async()=>{const t=te();return q.getQueryData(t.queryKey)??await e.fetchQuery(t)},m=Z(),se=()=>{const{t:e}=f(),t=ee(),{product_types:a}=W({limit:1e3,offset:0}),{product_tags:o}=G({limit:1e3,offset:0}),{sales_channels:i}=Y({limit:1e3,fields:"id,name"});return C.useMemo(()=>{const l=[...t];return a!=null&&a.length&&l.push(m.accessor("type_id",{label:e("fields.type"),type:"multiselect",options:a.map(r=>({label:r.value,value:r.id}))})),o!=null&&o.length&&l.push(m.accessor("tag_id",{label:e("fields.tag"),type:"multiselect",options:o.map(r=>({label:r.value,value:r.id}))})),i!=null&&i.length&&l.push(m.accessor("sales_channel_id",{label:e("fields.salesChannel"),type:"multiselect",options:i.map(r=>({label:r.name,value:r.id}))})),l.push(m.accessor("status",{label:e("fields.status"),type:"multiselect",options:[{label:e("products.productStatus.draft"),value:"draft"},{label:e("products.productStatus.proposed"),value:"proposed"},{label:e("products.productStatus.published"),value:"published"},{label:e("products.productStatus.rejected"),value:"rejected"}]})),l},[a,o,i,t,e])};function ae(){return L({entity:"products",queryPrefix:"p",pageSize:20,columnAdapter:_,useData:(e,t)=>{const{products:a,count:o,isError:i,error:l,isLoading:r}=P({fields:e,...t,is_giftcard:!1},{placeholderData:(c,n)=>{var u,p;const d=(p=(u=n==null?void 0:n[n.length-1])==null?void 0:u.query)==null?void 0:p.fields;if(!(d&&d!==e))return c}});return{data:a,count:o,isLoading:r,isError:i,error:l}},getRowHref:e=>`/products/${e.id}`})}function re(){const e=se();return{...ae(),filters:e}}var oe=()=>{const{t:e}=f(),t=v(),a=re();return s.jsxs(s.Fragment,{children:[s.jsx(A,{adapter:a,heading:e("products.domain"),actions:[{label:e("actions.export"),to:`export${t.search}`},{label:e("actions.import"),to:"import"},{label:e("actions.create"),to:"create"}]}),s.jsx(T,{})]})},x=20,ie=()=>{const{t:e}=f(),t=v();if(z("view_configurations"))return s.jsx(oe,{});const o=H(),{searchParams:i,raw:l}=S({pageSize:x}),{products:r,count:c,isLoading:n,isError:d,error:u}=P({...i,is_giftcard:!1},{initialData:o,placeholderData:R}),p=U(),y=ce(),{table:D}=J({data:r??[],columns:y,count:c,enablePagination:!0,pageSize:x,getRowId:b=>b.id});if(d)throw u;return s.jsxs($,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(M,{level:"h2",children:e("products.domain")}),s.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:`export${t.search}`,children:e("actions.export")})}),s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:"import",children:e("actions.import")})}),s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:"create",children:e("actions.create")})})]})]}),s.jsx(Q,{table:D,columns:y,count:c,pageSize:x,filters:p,search:!0,pagination:!0,isLoading:n,queryObject:l,navigateTo:b=>`${b.original.id}`,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],noRecords:{message:e("products.list.noRecordsMessage")}}),s.jsx(T,{})]})},le=({product:e})=>{const{t}=f(),a=B(),{mutateAsync:o}=K(e.id),i=async()=>{await a({title:t("general.areYouSure"),description:t("products.deleteWarning",{title:e.title}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await o(void 0,{onSuccess:()=>{j.success(t("products.toasts.delete.success.header"),{description:t("products.toasts.delete.success.description",{title:e.title})})},onError:r=>{j.error(t("products.toasts.delete.error.header"),{description:r.message})}})};return s.jsx(N,{groups:[{actions:[{icon:s.jsx(O,{}),label:t("actions.edit"),to:`/products/${e.id}/edit`}]},{actions:[{icon:s.jsx(I,{}),label:t("actions.delete"),onClick:i}]}]})},ne=V(),ce=()=>{const e=w();return C.useMemo(()=>[...e,ne.display({id:"actions",cell:({row:a})=>s.jsx(le,{product:a.original})})],[e])},Me=()=>{const{getWidgets:e}=E();return s.jsx(X,{widgets:{after:e("product.list.after"),before:e("product.list.before")},children:s.jsx(ie,{})})};export{Me as Component,$e as productLoader};
